<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Main function to create a zenplot — zenplot • zenplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Main function to create a zenplot — zenplot"><meta name="description" content="Constructs and draws a zigzag expanded navigation plot for a
graphical exploratory analysis of a path of variables.  The result is an
alternating sequence of one-dimensional (1d) and two-dimensional (2d) plots
laid out in a zigzag-like structure so that each consecutive pair of 2d plots has one of its
variates (or coordinates) in common with that of the 1d plot appearing between them."><meta property="og:description" content="Constructs and draws a zigzag expanded navigation plot for a
graphical exploratory analysis of a path of variables.  The result is an
alternating sequence of one-dimensional (1d) and two-dimensional (2d) plots
laid out in a zigzag-like structure so that each consecutive pair of 2d plots has one of its
variates (or coordinates) in common with that of the 1d plot appearing between them."><meta property="og:image" content="https://great-northern-diver.github.io/zenplots/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">zenplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/selected_features.html">Selected features</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-publications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Publications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-publications"><li><a class="external-link dropdown-item" href="https://doi.org/10.18637/jss.v095.i04">Zigzag Expanded Navigation Plots in R — JSS</a></li>
    <li><a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/pii/S245230621730031X">Visualizing dependence (S&amp;P 500)</a></li>
    <li><a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/pii/S0047259X1830023X">Measuring association of random vectors</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/great-northern-diver/zenplots" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Main function to create a zenplot</h1>
      <small class="dont-index">Source: <a href="https://github.com/great-northern-diver/zenplots/blob/HEAD/R/zenplot.R" class="external-link"><code>R/zenplot.R</code></a></small>
      <div class="d-none name"><code>zenplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructs and draws a zigzag expanded navigation plot for a
graphical exploratory analysis of a path of variables.  The result is an
alternating sequence of one-dimensional (1d) and two-dimensional (2d) plots
laid out in a zigzag-like structure so that each consecutive pair of 2d plots has one of its
variates (or coordinates) in common with that of the 1d plot appearing between them.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, turns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        first1d <span class="op">=</span> <span class="cn">TRUE</span>, last1d <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        n2dcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"letter"</span>, <span class="st">"square"</span>, <span class="st">"A4"</span>, <span class="st">"golden"</span>, <span class="st">"legal"</span><span class="op">)</span>,</span>
<span>        n2dplots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        plot1d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"points"</span>, <span class="st">"jitter"</span>, <span class="st">"density"</span>, <span class="st">"boxplot"</span>, <span class="st">"hist"</span>,</span>
<span>                   <span class="st">"rug"</span>, <span class="st">"arrow"</span>, <span class="st">"rect"</span>, <span class="st">"lines"</span>, <span class="st">"layout"</span><span class="op">)</span>,</span>
<span>        plot2d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"points"</span>, <span class="st">"density"</span>, <span class="st">"axes"</span>, <span class="st">"label"</span>, <span class="st">"arrow"</span>, <span class="st">"rect"</span>, <span class="st">"layout"</span><span class="op">)</span>,</span>
<span>        zargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">TRUE</span>, turns <span class="op">=</span> <span class="cn">TRUE</span>, orientations <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  vars <span class="op">=</span> <span class="cn">TRUE</span>, num <span class="op">=</span> <span class="cn">TRUE</span>, lim <span class="op">=</span> <span class="cn">TRUE</span>, labs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  width1d <span class="op">=</span> <span class="cn">TRUE</span>, width2d <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  ispace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">pkg</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"graphics"</span><span class="op">)</span>,</span>
<span>        lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"individual"</span>, <span class="st">"groupwise"</span>, <span class="st">"global"</span><span class="op">)</span>,</span>
<span>        labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"G"</span>, var <span class="op">=</span> <span class="st">"V"</span>, sep <span class="op">=</span> <span class="st">", "</span>, group2d <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>        pkg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"graphics"</span>, <span class="st">"grid"</span>, <span class="st">"loon"</span><span class="op">)</span>,</span>
<span>        method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tidy"</span>, <span class="st">"double.zigzag"</span>, <span class="st">"single.zigzag"</span>, <span class="st">"rectangular"</span><span class="op">)</span>,</span>
<span>        width1d <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">plot1d</span><span class="op">)</span><span class="op">)</span> <span class="fl">0.5</span> <span class="kw">else</span> <span class="fl">1</span>,</span>
<span>        width2d <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        ospace <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">pkg</span> <span class="op">==</span> <span class="st">"loon"</span><span class="op">)</span> <span class="fl">0</span> <span class="kw">else</span> <span class="fl">0.02</span>,</span>
<span>        ispace <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">pkg</span> <span class="op">==</span> <span class="st">"graphics"</span><span class="op">)</span> <span class="fl">0</span> <span class="kw">else</span> <span class="fl">0.037</span>,</span>
<span>        draw <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A data object of "standard forms", being a <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></code>, or a <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code>,
or a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>, or a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> of any of these.
In the case of a list, the components of <code>x</code> are interpreted as
groups of data which are visually separated by a two-dimensional
(group) plot.</p></dd>


<dt id="arg-turns">turns<a class="anchor" aria-label="anchor" href="#arg-turns"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> vector (of length two times the
number of variables to be plotted minus 1) consisting of <code>"d"</code>,
<code>"u"</code>, <code>"r"</code> or <code>"l"</code> indicating the turns out of the
current plot position; if <code>NULL</code>, the <code>turns</code> are
constructed (if <code>x</code> is of the "standard form" described above).</p></dd>


<dt id="arg-first-d">first1d<a class="anchor" aria-label="anchor" href="#arg-first-d"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> indicating whether the first
one-dimensional plot is included.</p></dd>


<dt id="arg-last-d">last1d<a class="anchor" aria-label="anchor" href="#arg-last-d"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> indicating whether the last
one-dimensional plot is included.</p></dd>


<dt id="arg-n-dcols">n2dcols<a class="anchor" aria-label="anchor" href="#arg-n-dcols"></a></dt>
<dd><p>number of columns of 2d plots (\(\ge 1\))
or one of <code>"letter"</code>, <code>"square"</code>, <code>"A4"</code>,
<code>"golden"</code> or <code>"legal"</code>
in which case a similar layout is constructed.
Note that <code>n2dcols</code> is ignored if <code>!is.null(turns)</code>.</p></dd>


<dt id="arg-n-dplots">n2dplots<a class="anchor" aria-label="anchor" href="#arg-n-dplots"></a></dt>
<dd><p>The number of 2d plots.</p></dd>


<dt id="arg-plot-d">plot1d<a class="anchor" aria-label="anchor" href="#arg-plot-d"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/function.html" class="external-link">function</a></code> to use to return a
       one-dimensional plot constructed with package <code>pkg</code>.
       Alternatively, a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> string of an existing
       function.
       For the defaults provided, the corresponding functions
       are obtained when appending <code>_1d_graphics</code>, <code>_1d_grid</code>
       or <code>_1d_loon</code> depending on which <code>pkg</code> is used.</p>
<p>If <code>plot1d = NULL</code>, then no 1d plot is produced in the <code>zenplot</code>.</p></dd>


<dt id="arg-plot-d">plot2d<a class="anchor" aria-label="anchor" href="#arg-plot-d"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/function.html" class="external-link">function</a></code> returning a two-dimensional plot
       constructed with package <code>pkg</code>.
       Alternatively, a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> string of an existing
       function. For the defaults provided, the corresponding functions
       are obtained when appending <code>_2d_graphics</code>, <code>_2d_grid</code>
       or <code>_2d_loon</code> depending on which <code>pkg</code> is used.</p>
<p>As for <code>plot1d</code>, <code>plot2d</code> omits 2d plots if <code>plot2d = NULL</code>.</p></dd>


<dt id="arg-zargs">zargs<a class="anchor" aria-label="anchor" href="#arg-zargs"></a></dt>
<dd><p>A fully named <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></code>
       indicating whether the respective arguments are (possibly) passed to
       <code>plot1d()</code> and <code>plot2d()</code> (if the latter contain the
       formal argument <code>zargs</code>, which they typically do/should, but
       see below for an example in which they do not).</p>
<p><code>zargs</code> can maximally contain all variables as given in the default.
       If one of those variables does not appear in <code>zargs</code>, it is
       treated as <code>TRUE</code> and the corresponding arguments are passed
       on to <code>plot1d</code> and <code>plot2d</code>. If one of them is set to
       <code>FALSE</code>, the argument is not passed on.</p></dd>


<dt id="arg-lim">lim<a class="anchor" aria-label="anchor" href="#arg-lim"></a></dt>
<dd><p>(x-/y-)axis limits. This can be a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> string
       or a <code>numeric(2)</code>.</p>
<p>If <code>lim = "groupwise"</code> and <code>x</code> does not contain groups,
       the behaviour is equivalent to <code>lim = "global"</code>.</p></dd>


<dt id="arg-labs">labs<a class="anchor" aria-label="anchor" href="#arg-labs"></a></dt>
<dd><p>The plot labels to be used; see the argument <code>labs</code> of
<code><a href="burst.html">burst</a>()</code> for the exact specification.
<code>labs</code> can, in general, be anything as long as <code>plot1d</code>
and <code>plot2d</code> know how to deal with it.</p></dd>


<dt id="arg-pkg">pkg<a class="anchor" aria-label="anchor" href="#arg-pkg"></a></dt>
<dd><p>The R package used for plotting (depends on how the
functions <code>plot1d</code> and <code>plot2d</code> were constructed;
the user is responsible for choosing the appropriate package
among the supported ones).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The type of zigzag plot (a <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code>).</p>
<p>Available are:</p><dl><dt><code>tidy</code>:</dt>
<dd><p>more tidied-up <code>double.zigzag</code>
                (slightly more compact placement of plots towards the end).</p></dd>

           <dt><code>double.zigzag</code>:</dt>
<dd><p>zigzag plot in the form of a
               flipped “S”. Along this path, the plots
               are placed in the form of an “S” which is rotated
               counterclockwise by 90 degrees.</p></dd>

           <dt><code>single.zigzag</code>:</dt>
<dd><p>zigzag plot in the form of a
               flipped “S”.</p></dd>

           <dt><code>rectangular</code>:</dt>
<dd><p>plots that fill the page from
               left to right and top to bottom. This is useful (and most compact)
               for plots that do not share an axis.</p></dd>


</dl><p>Note that <code>method</code> is ignored if <code>turns</code> are provided.</p></dd>


<dt id="arg-width-d">width1d<a class="anchor" aria-label="anchor" href="#arg-width-d"></a></dt>
<dd><p>A graphical parameter &gt; 0 giving the width of 1d plots.</p></dd>


<dt id="arg-width-d">width2d<a class="anchor" aria-label="anchor" href="#arg-width-d"></a></dt>
<dd><p>A graphical parameter &gt; 0 giving the height of 2d plots.</p></dd>


<dt id="arg-ospace">ospace<a class="anchor" aria-label="anchor" href="#arg-ospace"></a></dt>
<dd><p>The outer space around the zenplot.   A vector
       of length four (bottom, left, top, right),
       or one whose values are repeated to be of length four,
       which gives the outer space between the device region and
       the inner plot region around the zenplot.</p>
<p>Values should be in \([0,1]\)  when <code>pkg</code> is <code>"graphics"</code> or
       <code>"grid"</code>, and as number of pixels when<code>pkg</code> is <code>"loon"</code>.</p></dd>


<dt id="arg-ispace">ispace<a class="anchor" aria-label="anchor" href="#arg-ispace"></a></dt>
<dd><p>The inner space in \([0,1]\) between the each figure region
and the region of the (1d/2d) plot it contains.
Again, a vector of length four (bottom, left, top, right) or a shorter one
whose values are repeated to produce a vector of length four.</p></dd>


<dt id="arg-draw">draw<a class="anchor" aria-label="anchor" href="#arg-draw"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> indicating whether a the <code>zenplot</code>
is immediately displayed (the default) or not.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed to the drawing functions for both <code>plot1d</code> and
<code>plot2d</code>. If you need to pass certain arguments only to one
of them, say, <code>plot2d</code>, consider providing your own
<code>plot2d</code>; see the examples below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>(besides plotting) invisibly returns a list having additional classnames
       marking it as a zenplot and a zenPkg object (with Pkg being one of Graphics,
       Grid, or Loon, so as to identify the
       package used to construct the plot).</p>
<p>As a list it contains at least
       the path and layout (see <code><a href="unfold.html">unfold</a></code> for details).</p>
<p>Depending on the graphics package <code>pkg</code> used, the returned list
       includes additional components.  For <code>pkg = "grid"</code>,
       this will be the whole plot as a <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></code> (grid object).
       For <code>pkg = "loon"</code>,  this will be the whole plot as a
       <code>loon</code> plot object as
       well as the toplevel <code>tk</code> object in which the plot appears.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>All provided default <code>plot1d</code> and <code>plot2d</code> functions.</p>
<p><code><a href="extract_1d.html">extract_1d</a>()</code> and <code><a href="extract_2d.html">extract_2d</a>()</code>
for how <code>zargs</code> can be split up into a list of columns and corresponding
group and variable information.</p>
<p><code><a href="burst.html">burst</a>()</code> for how <code>x</code> can be split up into all sorts of
information useful for plotting (see our default <code>plot1d</code> and <code>plot2d</code>).
<code><a href="vport.html">vport</a>()</code> for how to construct a viewport for
(our default) <span class="pkg">grid</span> (<code>plot1d</code> and <code>plot2d</code>) functions.</p>
<p><code><a href="extract_pairs.html">extract_pairs</a>()</code>, <code><a href="connect_pairs.html">connect_pairs</a>()</code>,
<code><a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">group</a>()</code> and <code><a href="zenpath.html">zenpath</a>()</code> for
(zen)path-related functions.</p>
<p>The various vignettes for additional examples.</p>
<p>Other creating zenplots:
<code><a href="unfold.html">unfold</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marius Hofert and Wayne Oldford</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Basics #####################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate some data</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># dimension</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">271</span><span class="op">)</span> <span class="co"># set seed (for reproducibility)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">d</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">d</span><span class="op">)</span> <span class="co"># i.i.d. N(0,1) data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A basic zenplot</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">uf</span> <span class="op">&lt;-</span> <span class="fu"><a href="unfold.html">unfold</a></span><span class="op">(</span>nfaces <span class="op">=</span> <span class="va">d</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## `res` and `uf` is not identical as `res` has specific</span></span></span>
<span class="r-in"><span><span class="co">## class attributes.</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">uf</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">res</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>, <span class="va">uf</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## =&gt; The return value of zenplot() is the underlying unfold()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Some missing data</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span></span></span>
<span class="r-in"><span><span class="va">z</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># all NA except 10 points</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Another column with fully missing data (use arrows)</span></span></span>
<span class="r-in"><span><span class="co">## Note: This could be more 'compactified', but is technically</span></span></span>
<span class="r-in"><span><span class="co">##       more involved</span></span></span>
<span class="r-in"><span><span class="va">z</span><span class="op">[</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># all NA</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Lists of vectors, matrices and data frames as arguments (=&gt; groups of data)</span></span></span>
<span class="r-in"><span><span class="co">## Only two vectors</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A matrix and a vector</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A matrix, NA column and a vector</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Without labels or with different labels</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, C <span class="op">=</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, labs <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># without any labels</span></span></span>
<span class="r-plt img"><img src="zenplot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># without group labels</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group <span class="op">=</span> <span class="cn">NULL</span>, group2d <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># without group labels unless groups change</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># without variable labels</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>var <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># change default labels</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"Variable "</span>, sep <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example with a factor</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">iris</span>, lim <span class="op">=</span> <span class="st">"global"</span><span class="op">)</span> <span class="co"># global scaling of axis</span></span></span>
<span class="r-plt img"><img src="zenplot-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># acts as 'global' here (no groups in the data)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">iris</span>, lim <span class="op">=</span> <span class="st">"groupwise"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### More sophisticated examples ################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note: The third component (data.frame) naturally has default labels.</span></span></span>
<span class="r-in"><span><span class="co">##       zenplot() uses these labels and prepends a default group label.</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">19</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># change the group label (var and sep are defaults)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"Group "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, give z labels</span></span></span>
<span class="r-in"><span> <span class="co"># give group names</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="co"># uses given group names</span></span></span>
<span class="r-plt img"><img src="zenplot-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## Now let's change the variable labels</span></span></span>
<span class="r-in"><span><span class="va">z.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">z</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z.</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                     <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">is.matrix</a></span><span class="op">(</span><span class="va">z.</span><span class="op">)</span><span class="op">)</span> <span class="va">z.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">z.</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">z.</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Var."</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     <span class="va">z.</span></span></span>
<span class="r-in"><span>                     <span class="op">}</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z.</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### A dynamic plot based on 'loon' </span></span></span>
<span class="r-in"><span>  <span class="co"># (if installed and R compiled with tcl support)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"loon"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, pkg <span class="op">=</span> <span class="st">"loon"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Providing your own turns ###################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A basic example</span></span></span>
<span class="r-in"><span><span class="va">turns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>,<span class="st">"d"</span>,<span class="st">"d"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"d"</span>,<span class="st">"d"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"u"</span>,<span class="st">"u"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"u"</span>,<span class="st">"u"</span>,<span class="st">"l"</span>,<span class="st">"l"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"u"</span>,<span class="st">"u"</span>,<span class="st">"l"</span>,<span class="st">"l"</span>,<span class="st">"u"</span>,<span class="st">"u"</span>,<span class="st">"l"</span>,<span class="st">"l"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"d"</span>,<span class="st">"d"</span>,<span class="st">"l"</span>,<span class="st">"l"</span>,<span class="st">"d"</span>,<span class="st">"d"</span>,<span class="st">"l"</span>,<span class="st">"l"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"d"</span>,<span class="st">"d"</span>,<span class="st">"r"</span>,<span class="st">"r"</span>,<span class="st">"d"</span>,<span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-in"><span>           </span></span>
<span class="r-in"><span>  <span class="co"># layout of plot regions</span></span></span>
<span class="r-in"><span>  <span class="co"># =&gt; The tiles stick together as ispace = 0.</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="st">"layout"</span>, plot2d <span class="op">=</span> <span class="st">"layout"</span>, turns <span class="op">=</span> <span class="va">turns</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># layout of plot regions with grid</span></span></span>
<span class="r-in"><span>  <span class="co"># =&gt; Here the tiles show the small (default) ispace</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="st">"layout"</span>, plot2d <span class="op">=</span> <span class="st">"layout"</span>, </span></span>
<span class="r-in"><span>        turns <span class="op">=</span> <span class="va">turns</span>,</span></span>
<span class="r-in"><span>        pkg <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Another example (with own turns and groups)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>, plot1d <span class="op">=</span> <span class="st">"arrow"</span>, plot2d <span class="op">=</span> <span class="st">"rect"</span>,</span></span>
<span class="r-in"><span>        turns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"d"</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"d"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span><span class="op">)</span>, last1d <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Providing your own plot1d() or plot2d() ####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Creating a box</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="st">"label"</span>, plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="density_2d_graphics.html">density_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, box <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-22.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With grid </span></span></span>
<span class="r-in"><span> <span class="co"># (grid is in Imports; call fully-qualified to avoid library())</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="st">"label"</span>, plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="density_2d_grid.html">density_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span>, box <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, pkg <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-23.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An example with width1d = width2d and where no zargs are passed on.</span></span></span>
<span class="r-in"><span><span class="co">## Note: This could have also been done with </span></span></span>
<span class="r-in"><span><span class="co">##       'rect_2d_graphics(zargs, col = ...)'</span></span></span>
<span class="r-in"><span><span class="co">##       as plot1d and plot2d.</span></span></span>
<span class="r-in"><span><span class="va">myrect</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, type <span class="op">=</span> <span class="st">"n"</span>, ann <span class="op">=</span> <span class="cn">FALSE</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>         xlim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, ylim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span>xleft <span class="op">=</span> <span class="fl">0</span>, ybottom <span class="op">=</span> <span class="fl">0</span>, xright <span class="op">=</span> <span class="fl">1</span>, ytop <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        n2dcol <span class="op">=</span> <span class="st">"square"</span>, width1d <span class="op">=</span> <span class="fl">10</span>, width2d <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>        plot1d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu">myrect</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"royalblue3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu">myrect</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"maroon3"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-24.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Colorized rugs as plot1d()</span></span></span>
<span class="r-in"><span><span class="va">basecol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"royalblue3"</span>, <span class="st">"darkorange2"</span>, <span class="st">"maroon3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="va">basecol</span>, space <span class="op">=</span> <span class="st">"Lab"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="co"># different color for each 1d plot</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>              <span class="fu"><a href="rug_1d_graphics.html">rug_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="op">(</span><span class="va">zargs</span><span class="op">$</span><span class="va">num</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>              <span class="op">}</span></span></span>
<span class="r-in"><span>       <span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-25.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With grid (no library(), fully qualify)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, pkg <span class="op">=</span> <span class="st">"grid"</span>,</span></span>
<span class="r-in"><span>            plot1d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="rug_1d_grid.html">rug_1d_grid</a></span><span class="op">(</span><span class="va">zargs</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="op">(</span><span class="va">zargs</span><span class="op">$</span><span class="va">num</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-26.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Rectangles with labels as plot2d() (shows how to overlay plots)</span></span></span>
<span class="r-in"><span><span class="co">## With graphics</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="st">"arrow"</span>, plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="rect_2d_graphics.html">rect_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="label_2d_graphics.html">label_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-27.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With grid (no library(), fully qualify grid helpers)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, pkg <span class="op">=</span> <span class="st">"grid"</span>, plot1d <span class="op">=</span> <span class="st">"arrow"</span>, plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span>children <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span><span class="fu"><a href="rect_2d_grid.html">rect_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                           <span class="fu"><a href="label_2d_grid.html">label_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-28.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Rectangles with labels outside the 2d plotting region as plot2d()</span></span></span>
<span class="r-in"><span><span class="co">## With graphics</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, plot1d <span class="op">=</span> <span class="st">"arrow"</span>, plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="rect_2d_graphics.html">rect_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="label_2d_graphics.html">label_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, xpd <span class="op">=</span> <span class="cn">NA</span>, srt <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>                      loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.04</span>, <span class="fl">0</span><span class="op">)</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-29.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With grid (no library(), fully qualify)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>    <span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, pkg <span class="op">=</span> <span class="st">"grid"</span>, plot1d <span class="op">=</span> <span class="st">"arrow"</span>, plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span>children <span class="op">=</span> </span></span>
<span class="r-in"><span>                    <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span><span class="fu"><a href="rect_2d_grid.html">rect_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                <span class="fu"><a href="label_2d_grid.html">label_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span>, loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.04</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                rot <span class="op">=</span> <span class="fl">90</span>, cex <span class="op">=</span> <span class="fl">0.45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-30.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2d density with points, 1d arrows and labels</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>, </span></span>
<span class="r-in"><span>        plot1d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                       <span class="fu"><a href="rect_1d_graphics.html">rect_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="fu"><a href="arrow_1d_graphics.html">arrow_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, </span></span>
<span class="r-in"><span>                                         add <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                                         loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="fu"><a href="label_1d_graphics.html">label_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, </span></span>
<span class="r-in"><span>                                         add <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                                         loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="op">}</span>, </span></span>
<span class="r-in"><span>        plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                       <span class="fu"><a href="points_2d_graphics.html">points_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, </span></span>
<span class="r-in"><span>                                          col <span class="op">=</span> </span></span>
<span class="r-in"><span>                                          <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"black"</span>, </span></span>
<span class="r-in"><span>                                                                 alpha.f <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="fu"><a href="density_2d_graphics.html">density_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                       <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-31.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2d density with labels, 1d histogram with density and label</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>    plot1d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="hist_1d_graphics.html">hist_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="density_1d_graphics.html">density_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                        border <span class="op">=</span> <span class="st">"royalblue3"</span>,</span></span>
<span class="r-in"><span>                                        lwd <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="label_1d_graphics.html">label_1d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                      loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                      cex <span class="op">=</span> <span class="fl">0.6</span>, font <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                      col <span class="op">=</span> <span class="st">"darkorange2"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">}</span>,</span></span>
<span class="r-in"><span>    plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="density_2d_graphics.html">density_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="fu"><a href="points_2d_graphics.html">points_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                       col <span class="op">=</span> </span></span>
<span class="r-in"><span>                                       <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"black"</span>, </span></span>
<span class="r-in"><span>                                                              alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                <span class="op">}</span></span></span>
<span class="r-in"><span>            <span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-32.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### More sophisticated examples ################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example: Overlaying histograms with densities (the *proper* way)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Define proper 1d plot for overlaying histograms with densities</span></span></span>
<span class="r-in"><span><span class="va">hist_with_density_1d</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">num</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">num</span></span></span>
<span class="r-in"><span>    <span class="va">turn.out</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">turns</span><span class="op">[</span><span class="va">num</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">horizontal</span> <span class="op">&lt;-</span> <span class="va">turn.out</span> <span class="op">==</span> <span class="st">"d"</span> <span class="op">||</span> <span class="va">turn.out</span> <span class="op">==</span> <span class="st">"u"</span></span></span>
<span class="r-in"><span>    <span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="plot_indices.html">plot_indices</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="va">ii</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">srt</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span><span class="va">horizontal</span><span class="op">)</span> <span class="fl">0</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">turn.out</span> <span class="op">==</span> <span class="st">"r"</span><span class="op">)</span> <span class="op">-</span><span class="fl">90</span> <span class="kw">else</span> <span class="fl">90</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="va">ii</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">lim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, to <span class="op">=</span> <span class="va">lim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">binInfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">breaks</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">binBoundaries</span> <span class="op">&lt;-</span> <span class="va">binInfo</span><span class="op">$</span><span class="va">breaks</span></span></span>
<span class="r-in"><span>    <span class="va">widths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">binBoundaries</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">heights</span> <span class="op">&lt;-</span> <span class="va">binInfo</span><span class="op">$</span><span class="va">density</span></span></span>
<span class="r-in"><span>    <span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">xvals</span> <span class="op">&lt;-</span> <span class="va">dens</span><span class="op">$</span><span class="va">x</span></span></span>
<span class="r-in"><span>    <span class="va">keepers</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">xvals</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">xvals</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x.</span> <span class="op">&lt;-</span> <span class="va">xvals</span><span class="op">[</span><span class="va">keepers</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">y.</span> <span class="op">&lt;-</span> <span class="va">dens</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">keepers</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="va">turn.out</span> <span class="op">==</span> <span class="st">"d"</span> <span class="op">||</span> <span class="va">turn.out</span> <span class="op">==</span> <span class="st">"l"</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span>              <span class="va">heights</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">heights</span>; <span class="va">y.</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">y.</span> </span></span>
<span class="r-in"><span>              <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="va">horizontal</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">xlim</span> <span class="op">&lt;-</span> <span class="va">lim</span>; <span class="va">xlim.bp</span> <span class="op">&lt;-</span> <span class="va">xlim</span> <span class="op">-</span> <span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">heights</span>, <span class="va">y.</span><span class="op">)</span>; <span class="va">ylim.bp</span> <span class="op">&lt;-</span> <span class="va">ylim</span></span></span>
<span class="r-in"><span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x.</span>, <span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">y.</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">heights</span>, <span class="va">y.</span><span class="op">)</span>; <span class="va">xlim.bp</span> <span class="op">&lt;-</span> <span class="va">xlim</span></span></span>
<span class="r-in"><span>        <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="va">lim</span>; <span class="va">ylim.bp</span> <span class="op">&lt;-</span> <span class="va">ylim</span> <span class="op">-</span> <span class="va">ylim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">x</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">y.</span>, <span class="fl">0</span><span class="op">)</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x.</span>, <span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">ylim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="va">turn.out</span> <span class="op">==</span> <span class="st">"d"</span><span class="op">)</span> <span class="va">loc</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">loc</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="va">turn.out</span> <span class="op">==</span> <span class="st">"r"</span><span class="op">)</span> <span class="op">{</span> <span class="va">loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span>; <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="va">turn.out</span> <span class="op">==</span> <span class="st">"l"</span><span class="op">)</span> <span class="op">{</span> <span class="va">loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span>; <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">heights</span>, width <span class="op">=</span> <span class="va">widths</span>, xlim <span class="op">=</span> <span class="va">xlim.bp</span>, ylim <span class="op">=</span> <span class="va">ylim.bp</span>,</span></span>
<span class="r-in"><span>            space <span class="op">=</span> <span class="fl">0</span>, horiz <span class="op">=</span> <span class="op">!</span><span class="va">horizontal</span>, </span></span>
<span class="r-in"><span>            main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, border <span class="op">=</span> <span class="st">"royalblue3"</span>, lwd <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>usr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, labels <span class="op">=</span> <span class="va">label</span>, </span></span>
<span class="r-in"><span>         cex <span class="op">=</span> <span class="fl">0.7</span>, srt <span class="op">=</span> <span class="va">srt</span>, font <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>         col <span class="op">=</span> <span class="st">"darkorange2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>        plot1d <span class="op">=</span> <span class="st">"hist_with_density_1d"</span>,</span></span>
<span class="r-in"><span>        plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="density_2d_graphics.html">density_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="points_2d_graphics.html">points_2d_graphics</a></span><span class="op">(</span><span class="va">zargs</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                               col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"black"</span>, </span></span>
<span class="r-in"><span>                                                             alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in zenplot(x, plot1d = "hist_with_density_1d", plot2d = function(zargs) {    density_2d_graphics(zargs)    points_2d_graphics(zargs, add = TRUE, col = grDevices::adjustcolor("black",         alpha.f = 0.3))}):</span> Function provided as argument 'plot1d' does not exist.</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example: A path through pairs of a grouped t copula sample</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">d.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span>; <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">d.</span><span class="op">)</span>; <span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">d.</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span>; <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">271</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">d</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.5</span>, nrow <span class="op">=</span> <span class="va">d</span>, ncol <span class="op">=</span> <span class="va">d</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span>; <span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">L</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">U.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nu</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nu.</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span><span class="va">U.</span>, shape <span class="op">=</span> <span class="va">nu.</span><span class="op">/</span><span class="fl">2</span>, rate <span class="op">=</span> <span class="va">nu.</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">*</span> <span class="va">Y</span></span></span>
<span class="r-in"><span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span>, df <span class="op">=</span> <span class="va">nu</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="st">"black"</span>, nrow <span class="op">=</span> <span class="va">d</span>, ncol <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d.</span>, n <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">d.</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">d.</span><span class="op">)</span><span class="op">)</span> <span class="va">cols</span><span class="op">[</span><span class="va">start</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">:</span><span class="va">end</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">start</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">:</span><span class="va">end</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">basecol</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span>; <span class="va">cols</span> <span class="op">&lt;-</span> <span class="va">cols</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">my_panel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span>                  <span class="va">count</span> <span class="op">&lt;&lt;-</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>                  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="st">"."</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">count</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">U</span>, panel <span class="op">=</span> <span class="va">my_panel</span>, gap <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">as.expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span>, </span></span>
<span class="r-in"><span>                                   <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">U</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-33.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">my_points_2d_grid</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span>, <span class="va">basecol</span>, <span class="va">d.</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_2d.html">extract_2d</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">$</span><span class="va">x</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">$</span><span class="va">y</span>; <span class="va">xlim</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">$</span><span class="va">xlim</span>; <span class="va">ylim</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">$</span><span class="va">ylim</span></span></span>
<span class="r-in"><span>    <span class="va">num2d</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">num</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">vlabs</span><span class="op">[</span><span class="va">num2d</span><span class="op">:</span><span class="op">(</span><span class="va">num2d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">col</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">&lt;=</span> <span class="va">vars</span> <span class="op">&amp;</span> <span class="va">vars</span> <span class="op">&lt;=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">basecol</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="kw">else</span></span></span>
<span class="r-in"><span>             <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span> <span class="op">&lt;=</span> <span class="va">vars</span> <span class="op">&amp;</span> <span class="va">vars</span> <span class="op">&lt;=</span> <span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">d.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">basecol</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="kw">else</span></span></span>
<span class="r-in"><span>               <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">d.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">d.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span> <span class="op">&lt;=</span> <span class="va">vars</span> <span class="op">&amp;</span> <span class="va">vars</span> <span class="op">&lt;=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="va">basecol</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="kw">else</span> <span class="st">"black"</span></span></span>
<span class="r-in"><span>    <span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="vport.html">vport</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">$</span><span class="va">ispace</span>, xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">pointsGrob</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                     pch <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="st">"npc"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     name <span class="op">=</span> <span class="st">"points_2d"</span>, </span></span>
<span class="r-in"><span>                     gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">col</span><span class="op">)</span>, vp <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">d</span>; <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span>, size <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  4  7  1  2 13 16 11 14  3 15  5 12 10  6 17  9  8</span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">U</span><span class="op">[</span>,<span class="va">ord</span><span class="op">]</span>, plot1d <span class="op">=</span> <span class="st">"layout"</span>, plot2d <span class="op">=</span> <span class="st">"layout"</span>, pkg <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-34.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">U</span><span class="op">[</span>,<span class="va">ord</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        pkg <span class="op">=</span> <span class="st">"grid"</span>,</span></span>
<span class="r-in"><span>        plot1d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="fu"><a href="arrow_1d_grid.html">arrow_1d_grid</a></span><span class="op">(</span><span class="va">zargs</span>, col <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gTree</a></span><span class="op">(</span>children <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">gList</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                <span class="fu">my_points_2d_grid</span><span class="op">(</span><span class="va">zargs</span>, basecol <span class="op">=</span> <span class="va">basecol</span>, d. <span class="op">=</span> <span class="va">d.</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="rect_2d_grid.html">rect_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span>, </span></span>
<span class="r-in"><span>                             width <span class="op">=</span> <span class="fl">1.05</span>, height <span class="op">=</span> <span class="fl">1.05</span>, </span></span>
<span class="r-in"><span>                             col <span class="op">=</span> <span class="st">"grey50"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="fu"><a href="label_2d_grid.html">label_2d_grid</a></span><span class="op">(</span><span class="va">zargs</span>,</span></span>
<span class="r-in"><span>                              loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.06</span>, <span class="op">-</span><span class="fl">0.03</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                              rot <span class="op">=</span> <span class="fl">90</span>, cex <span class="op">=</span> <span class="fl">0.45</span>,</span></span>
<span class="r-in"><span>                              fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-35.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Using ggplot2 ##############################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Although not thoroughly tested, ggplot2 can be used via pkg = "grid".</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">my_points_2d_ggplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span>, <span class="va">extract2d</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="va">extract2d</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_2d.html">extract_2d</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">x</span>, <span class="va">r</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">cols</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"Species"</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="plot_indices.html">plot_indices</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">irs</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">x</span></span></span>
<span class="r-in"><span>      <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">irs</span><span class="op">[</span>,<span class="va">ii</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">irs</span><span class="op">[</span>,<span class="va">ii</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">cols</span> <span class="op">&lt;-</span> <span class="va">irs</span><span class="op">[</span>,<span class="st">"Species"</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">num2d</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">num</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>         <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, </span></span>
<span class="r-in"><span>                             <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, </span></span>
<span class="r-in"><span>                                          colour <span class="op">=</span> <span class="va">cols</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             show.legend <span class="op">=</span> <span class="op">(</span><span class="va">num2d</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                           <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="va">num2d</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span></span>
<span class="r-in"><span>                              legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html" class="external-link">ggplot_gtable</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html" class="external-link">ggplot_build</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">iris.</span> <span class="op">&lt;-</span> <span class="va">iris</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">iris.</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\\\."</span>, <span class="st">" "</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">zenplot</span><span class="op">(</span><span class="va">iris.</span>, n2dplots <span class="op">=</span> <span class="fl">3</span>, plot2d <span class="op">=</span> <span class="st">"my_points_2d_ggplot"</span>, </span></span>
<span class="r-in"><span>          pkg <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">zenplot</span><span class="op">(</span><span class="va">iris.</span>, n2dplots <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>          plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                    <span class="fu">my_points_2d_ggplot</span><span class="op">(</span><span class="va">zargs</span>, extract2d <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">}</span>,</span></span>
<span class="r-in"><span>          pkg <span class="op">=</span> <span class="st">"grid"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in zenplot(iris., n2dplots = 3, plot2d = "my_points_2d_ggplot",     pkg = "grid"):</span> Function provided as argument 'plot2d' does not exist.</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Providing your own data structure ##########################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">zenplot</span><span class="op">(</span><span class="va">z</span>, n2dplots <span class="op">=</span> <span class="fl">4</span>, plot1d <span class="op">=</span> <span class="st">"arrow"</span>, last1d <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        plot2d <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">$</span><span class="va">x</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="va">num2d</span> <span class="op">&lt;-</span> <span class="va">zargs</span><span class="op">$</span><span class="va">num</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">[[</span><span class="va">num2d</span><span class="op">]</span><span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">[[</span><span class="va">num2d</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>            <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">y</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"b"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">}</span>, ispace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="zenplot-36.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Zenplots based on 3d lattice plots #########################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"lattice"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gridExtra"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">mycloud</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">num</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/extendrange.html" class="external-link">extendrange</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, f <span class="op">=</span> <span class="fl">0.04</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/cloud.html" class="external-link">cloud</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">~</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                         xlim <span class="op">=</span> <span class="va">lim</span>, ylim <span class="op">=</span> <span class="va">lim</span>, zlim <span class="op">=</span> <span class="va">lim</span>,</span></span>
<span class="r-in"><span>                         xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">U</span><span class="op">[</span><span class="va">i.</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i. <span class="op">=</span> <span class="va">num</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">U</span><span class="op">[</span><span class="va">i.</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i. <span class="op">=</span> <span class="va">num</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         zlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">U</span><span class="op">[</span><span class="va">i.</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i. <span class="op">=</span> <span class="va">num</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         zoom <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>arrows <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         col <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>                         par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/standard.theme.html" class="external-link">standard.theme</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                             axis.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                             clip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>panel <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">plst.3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">mycloud</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="va">i</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>, num <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">plst.3d</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ncols</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">turns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">ncols</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"d"</span>, <span class="st">"d"</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">ncols</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">plot2d</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">zargs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">num2d</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">zargs</span><span class="op">$</span><span class="va">num</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="vport.html">vport</a></span><span class="op">(</span><span class="va">zargs</span><span class="op">$</span><span class="va">ispace</span>, xlim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, ylim <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">zargs</span><span class="op">$</span><span class="va">x</span><span class="op">[[</span><span class="va">num2d</span><span class="op">]</span><span class="op">]</span>, vp <span class="op">=</span> <span class="va">vp</span>, cl <span class="op">=</span> <span class="st">"lattice"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="fu">zenplot</span><span class="op">(</span><span class="va">plst.3d</span>, turns <span class="op">=</span> <span class="va">turns</span>, n2dplots <span class="op">=</span> <span class="va">num</span>, pkg <span class="op">=</span> <span class="st">"grid"</span>,</span></span>
<span class="r-in"><span>          first1d <span class="op">=</span> <span class="cn">FALSE</span>, last1d <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>          plot1d <span class="op">=</span> <span class="st">"arrow_1d_grid"</span>, plot2d <span class="op">=</span> <span class="va">plot2d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="zenplot-37.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="zenplot-38.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="zenplot-39.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="zenplot-40.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="zenplot-41.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marius Hofert, Wayne Oldford.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

