<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Main function to create a zenplot — zenplot • zenplots</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Main function to create a zenplot — zenplot" />
<meta property="og:description" content="Constructs and draws a zigzag expanded navigation plot for a
graphical exploratory analysis of a path of variables.  The result is an
alternating sequence of one-dimensional (1d) and two-dimensional (2d) plots
laid out in a zigzag-like structure so that each consecutive pair of 2d plots has one of its
variates (or coordinates) in common with that of the 1d plot appearing between them." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zenplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/intro.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/selected_features.html">Selected features</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://doi.org/10.18637/jss.v095.i04">Zigzag Expanded Navigation Plots in R -- Journal of Statistical Software</a>
    </li>
    <li>
      <a href="https://www.sciencedirect.com/science/article/pii/S245230621730031X">visualizing dependence - S&amp;P 500 data</a>
    </li>
    <li>
      <a href="https://www.sciencedirect.com/science/article/pii/S0047259X1830023X">measuring association of random vectors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/great-northern-diver/zenplots">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Main function to create a zenplot</h1>
    <small class="dont-index">Source: <a href='https://github.com/great-northern-diver/zenplots/blob/master/R/zenplot.R'><code>R/zenplot.R</code></a></small>
    <div class="hidden name"><code>zenplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Constructs and draws a zigzag expanded navigation plot for a
graphical exploratory analysis of a path of variables.  The result is an
alternating sequence of one-dimensional (1d) and two-dimensional (2d) plots
laid out in a zigzag-like structure so that each consecutive pair of 2d plots has one of its
variates (or coordinates) in common with that of the 1d plot appearing between them.</p>
    </div>

    <pre class="usage"><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, turns <span class='op'>=</span> <span class='cn'>NULL</span>,
        first1d <span class='op'>=</span> <span class='cn'>TRUE</span>, last1d <span class='op'>=</span> <span class='cn'>TRUE</span>,
        n2dcols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"letter"</span>, <span class='st'>"square"</span>, <span class='st'>"A4"</span>, <span class='st'>"golden"</span>, <span class='st'>"legal"</span><span class='op'>)</span>,
        n2dplots <span class='op'>=</span> <span class='cn'>NULL</span>,
        plot1d <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"label"</span>, <span class='st'>"points"</span>, <span class='st'>"jitter"</span>, <span class='st'>"density"</span>, <span class='st'>"boxplot"</span>, <span class='st'>"hist"</span>,
                   <span class='st'>"rug"</span>, <span class='st'>"arrow"</span>, <span class='st'>"rect"</span>, <span class='st'>"lines"</span>, <span class='st'>"layout"</span><span class='op'>)</span>,
        plot2d <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"points"</span>, <span class='st'>"density"</span>, <span class='st'>"axes"</span>, <span class='st'>"label"</span>, <span class='st'>"arrow"</span>, <span class='st'>"rect"</span>, <span class='st'>"layout"</span><span class='op'>)</span>,
        zargs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='cn'>TRUE</span>, turns <span class='op'>=</span> <span class='cn'>TRUE</span>, orientations <span class='op'>=</span> <span class='cn'>TRUE</span>,
                  vars <span class='op'>=</span> <span class='cn'>TRUE</span>, num <span class='op'>=</span> <span class='cn'>TRUE</span>, lim <span class='op'>=</span> <span class='cn'>TRUE</span>, labs <span class='op'>=</span> <span class='cn'>TRUE</span>,
                  width1d <span class='op'>=</span> <span class='cn'>TRUE</span>, width2d <span class='op'>=</span> <span class='cn'>TRUE</span>,
                  ispace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/match.arg.html'>match.arg</a></span><span class='op'>(</span><span class='va'>pkg</span><span class='op'>)</span> <span class='op'>!=</span> <span class='st'>"graphics"</span><span class='op'>)</span>,
        lim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"individual"</span>, <span class='st'>"groupwise"</span>, <span class='st'>"global"</span><span class='op'>)</span>,
        labs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='st'>"G"</span>, var <span class='op'>=</span> <span class='st'>"V"</span>, sep <span class='op'>=</span> <span class='st'>", "</span>, group2d <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
        pkg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"graphics"</span>, <span class='st'>"grid"</span>, <span class='st'>"loon"</span><span class='op'>)</span>,
        method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tidy"</span>, <span class='st'>"double.zigzag"</span>, <span class='st'>"single.zigzag"</span>, <span class='st'>"rectangular"</span><span class='op'>)</span>,
        width1d <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>plot1d</span><span class='op'>)</span><span class='op'>)</span> <span class='fl'>0.5</span> <span class='kw'>else</span> <span class='fl'>1</span>,
        width2d <span class='op'>=</span> <span class='fl'>10</span>,
        ospace <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>pkg</span> <span class='op'>==</span> <span class='st'>"loon"</span><span class='op'>)</span> <span class='fl'>0</span> <span class='kw'>else</span> <span class='fl'>0.02</span>,
        ispace <span class='op'>=</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>pkg</span> <span class='op'>==</span> <span class='st'>"graphics"</span><span class='op'>)</span> <span class='fl'>0</span> <span class='kw'>else</span> <span class='fl'>0.037</span>,
        draw <span class='op'>=</span> <span class='cn'>TRUE</span>,
        <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data object of "standard forms", being a <code><a href='https://rdrr.io/r/base/vector.html'>vector</a></code>, or a <code><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></code>,
or a <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code>, or a <code><a href='https://rdrr.io/r/base/list.html'>list</a></code> of any of these.
In the case of a list, the components of <code>x</code> are interpreted as
groups of data which are visually separated by a two-dimensional
(group) plot.</p></td>
    </tr>
    <tr>
      <th>turns</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> vector (of length two times the
number of variables to be plotted minus 1) consisting of <code>"d"</code>,
<code>"u"</code>, <code>"r"</code> or <code>"l"</code> indicating the turns out of the
current plot position; if <code>NULL</code>, the <code>turns</code> are
constructed (if <code>x</code> is of the "standard form" described above).</p></td>
    </tr>
    <tr>
      <th>first1d</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical</a></code> indicating whether the first
one-dimensional plot is included.</p></td>
    </tr>
    <tr>
      <th>last1d</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical</a></code> indicating whether the last
one-dimensional plot is included.</p></td>
    </tr>
    <tr>
      <th>n2dcols</th>
      <td><p>number of columns of 2d plots (\(\ge 1\))
or one of <code>"letter"</code>, <code>"square"</code>, <code>"A4"</code>,
<code>"golden"</code> or <code>"legal"</code>
in which case a similar layout is constructed.
Note that <code>n2dcols</code> is ignored if <code>!is.null(turns)</code>.</p></td>
    </tr>
    <tr>
      <th>n2dplots</th>
      <td><p>The number of 2d plots.</p></td>
    </tr>
    <tr>
      <th>plot1d</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/function.html'>function</a></code> to use to return a
       one-dimensional plot constructed with package <code>pkg</code>.
       Alternatively, a <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> string of an existing
       function.
       For the defaults provided, the corresponding functions
       are obtained when appending <code>_1d_graphics</code>, <code>_1d_grid</code>
       or <code>_1d_loon</code> depending on which <code>pkg</code> is used.</p>
<p>If <code>plot1d = NULL</code>, then no 1d plot is produced in the <code>zenplot</code>.</p></td>
    </tr>
    <tr>
      <th>plot2d</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/function.html'>function</a></code> returning a two-dimensional plot
       constructed with package <code>pkg</code>.
       Alternatively, a <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> string of an existing
       function. For the defaults provided, the corresponding functions
       are obtained when appending <code>_2d_graphics</code>, <code>_2d_grid</code>
       or <code>_2d_loon</code> depending on which <code>pkg</code> is used.</p>
<p>As for <code>plot1d</code>, <code>plot2d</code> omits 2d plots if <code>plot2d = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>zargs</th>
      <td><p>A fully named <code><a href='https://rdrr.io/r/base/logical.html'>logical</a></code> <code><a href='https://rdrr.io/r/base/vector.html'>vector</a></code>
       indicating whether the respective arguments are (possibly) passed to
       <code>plot1d()</code> and <code>plot2d()</code> (if the latter contain the
       formal argument <code>zargs</code>, which they typically do/should, but
       see below for an example in which they do not).</p>
<p><code>zargs</code> can maximally contain all variables as given in the default.
       If one of those variables does not appear in <code>zargs</code>, it is
       treated as <code>TRUE</code> and the corresponding arguments are passed
       on to <code>plot1d</code> and <code>plot2d</code>. If one of them is set to
       <code>FALSE</code>, the argument is not passed on.</p></td>
    </tr>
    <tr>
      <th>lim</th>
      <td><p>(x-/y-)axis limits. This can be a <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> string
       or a <code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code>.</p>
<p>If <code>lim = "groupwise"</code> and <code>x</code> does not contain groups,
       the behaviour is equivalent to <code>lim = "global"</code>.</p></td>
    </tr>
    <tr>
      <th>labs</th>
      <td><p>The plot labels to be used; see the argument <code>labs</code> of
<code><a href='burst.html'>burst</a>()</code> for the exact specification.
<code>labs</code> can, in general, be anything as long as <code>plot1d</code>
and <code>plot2d</code> know how to deal with it.</p></td>
    </tr>
    <tr>
      <th>pkg</th>
      <td><p>The R package used for plotting (depends on how the
functions <code>plot1d</code> and <code>plot2d</code> were constructed;
the user is responsible for choosing the appropriate package
among the supported ones).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The type of zigzag plot (a <code><a href='https://rdrr.io/r/base/character.html'>character</a></code>).</p>
<p>Available are:</p><dl>
           <dt><code>tidy</code>:</dt><dd><p>more tidied-up <code>double.zigzag</code>
                (slightly more compact placement of plots towards the end).</p></dd>
           <dt><code>double.zigzag</code>:</dt><dd><p>zigzag plot in the form of a
               flipped &#8220;S&#8221;. Along this path, the plots
               are placed in the form of an &#8220;S&#8221; which is rotated
               counterclockwise by 90 degrees.</p></dd>
           <dt><code>single.zigzag</code>:</dt><dd><p>zigzag plot in the form of a
               flipped &#8220;S&#8221;.</p></dd>
           <dt><code>rectangular</code>:</dt><dd><p>plots that fill the page from
               left to right and top to bottom. This is useful (and most compact)
               for plots that do not share an axis.</p></dd>
       
</dl><p>Note that <code>method</code> is ignored if <code>turns</code> are provided.</p></td>
    </tr>
    <tr>
      <th>width1d</th>
      <td><p>A graphical parameter &gt; 0 giving the width of 1d plots.</p></td>
    </tr>
    <tr>
      <th>width2d</th>
      <td><p>A graphical parameter &gt; 0 giving the height of 2d plots.</p></td>
    </tr>
    <tr>
      <th>ospace</th>
      <td><p>The outer space around the zenplot.   A vector
       of length four (bottom, left, top, right),
       or one whose values are repeated to be of length four,
       which gives the outer space between the device region and
       the inner plot region around the zenplot.</p>
<p>Values should be in \([0,1]\)  when <code>pkg</code> is <code>"graphics"</code> or
       <code>"grid"</code>, and as number of pixels when<code>pkg</code> is <code>"loon"</code>.</p></td>
    </tr>
    <tr>
      <th>ispace</th>
      <td><p>The inner space in \([0,1]\) between the each figure region
and the region of the (1d/2d) plot it contains.
Again, a vector of length four (bottom, left, top, right) or a shorter one
whose values are repeated to produce a vector of length four.</p></td>
    </tr>
    <tr>
      <th>draw</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical</a></code> indicating whether a the <code>zenplot</code>
is immediately displayed (the default) or not.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to the drawing functions for both <code>plot1d</code> and
<code>plot2d</code>. If you need to pass certain arguments only to one
of them, say, <code>plot2d</code>, consider providing your own
<code>plot2d</code>; see the examples below.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(besides plotting) invisibly returns a list having additional classnames
       marking it as a zenplot and a zenPkg object (with Pkg being one of Graphics,
       Grid, or Loon, so as to identify the
       package used to construct the plot).</p>       
<p>As a list it contains at least
       the path and layout (see <code><a href='unfold.html'>unfold</a></code> for details).</p>
<p>Depending on the graphics package <code>pkg</code> used, the returned list
       includes additional components.  For <code>pkg = "grid"</code>,
       this will be the whole plot as a <code><a href='https://rdrr.io/r/grid/grid.grob.html'>grob</a></code> (grid object).
       For <code>pkg = "loon"</code>,  this will be the whole plot as a
       <code>loon</code> plot object as
       well as the toplevel <code>tk</code> object in which the plot appears.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>All provided default <code>plot1d</code> and <code>plot2d</code> functions.</p>
<p><code><a href='extract_1d.html'>extract_1d</a>()</code> and <code><a href='extract_2d.html'>extract_2d</a>()</code>
for how <code>zargs</code> can be split up into a list of columns and corresponding
group and variable information.</p>
<p><code><a href='burst.html'>burst</a>()</code> for how <code>x</code> can be split up into all sorts of
information useful for plotting (see our default <code>plot1d</code> and <code>plot2d</code>).
<code><a href='vport.html'>vport</a>()</code> for how to construct a viewport for
(our default) <span class="pkg">grid</span> (<code>plot1d</code> and <code>plot2d</code>) functions.</p>
<p><code><a href='extract_pairs.html'>extract_pairs</a>()</code>, <code><a href='connect_pairs.html'>connect_pairs</a>()</code>,
<code><a href='https://ggplot2.tidyverse.org/reference/aes_group_order.html'>group</a>()</code> and <code><a href='zenpath.html'>zenpath</a>()</code> for
(zen)path-related functions.</p>
<p>The various vignettes for additional examples.</p>
<p>Other creating zenplots: 
<code><a href='unfold.html'>unfold</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Marius Hofert and Wayne Oldford</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### Basics #####################################################################</span>

<span class='co'>## Generate some data</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span> <span class='co'># sample size</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fl'>20</span> <span class='co'># dimension</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>271</span><span class='op'>)</span> <span class='co'># set seed (for reproducibility)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>*</span> <span class='va'>d</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span> <span class='co'># i.i.d. N(0,1) data</span>

<span class='co'>## A basic zenplot</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>uf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='unfold.html'>unfold</a></span><span class='op'>(</span>nfaces <span class='op'>=</span> <span class='va'>d</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='co'>## `res` and `uf` is not identical as `res` has specific</span>
<span class='co'>## class attributes.</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>name</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>uf</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>[[</span><span class='va'>name</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>uf</span><span class='op'>[[</span><span class='va'>name</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## =&gt; The return value of zenplot() is the underlying unfold()</span>

<span class='co'>## Some missing data</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='va'>x</span>
<span class='va'>z</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>10</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> <span class='co'># all NA except 10 points</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Another column with fully missing data (use arrows)</span>
<span class='co'>## Note: This could be more 'compactified', but is technically</span>
<span class='co'>##       more involved</span>
<span class='va'>z</span><span class='op'>[</span>, <span class='fl'>6</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> <span class='co'># all NA</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Lists of vectors, matrices and data frames as arguments (=&gt; groups of data)</span>
<span class='co'>## Only two vectors</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## A matrix and a vector</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## A matrix, NA column and a vector</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, <span class='cn'>NA</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Without labels or with different labels</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, B <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>, C <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, labs <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='co'># without any labels</span>
</div><div class='img'><img src='zenplot-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, labs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='cn'>NULL</span>, group2d <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># without group labels</span>
</div><div class='img'><img src='zenplot-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, labs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># without group labels unless groups change</span>
</div><div class='img'><img src='zenplot-11.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, labs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>var <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># without variable labels</span>
</div><div class='img'><img src='zenplot-12.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, labs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>var <span class='op'>=</span> <span class='st'>"Variable "</span>, sep <span class='op'>=</span> <span class='st'>" - "</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># change default labels</span>
</div><div class='img'><img src='zenplot-13.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Example with a factor</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-14.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>iris</span>, lim <span class='op'>=</span> <span class='st'>"global"</span><span class='op'>)</span> <span class='co'># global scaling of axis</span>
</div><div class='img'><img src='zenplot-15.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>iris</span>, lim <span class='op'>=</span> <span class='st'>"groupwise"</span><span class='op'>)</span> <span class='co'># acts as 'global' here (no groups in the data)</span>


<span class='co'>### More sophisticated examples ################################################</span>

<span class='co'>## Note: The third component (data.frame) naturally has default labels.</span>
<span class='co'>##       zenplot() uses these labels and prepends a default group label.</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>, <span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>7</span><span class='op'>]</span>, <span class='cn'>NA</span>,
          <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>/</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>8</span><span class='op'>:</span><span class='fl'>19</span><span class='op'>]</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>, <span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>20</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, labs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='st'>"Group "</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># change the group label (var and sep are defaults)</span>
</div><div class='img'><img src='zenplot-16.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Alternatively, give z labels</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Group"</span>, <span class='va'>LETTERS</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># give group names</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span> <span class='co'># uses given group names</span>
</div><div class='img'><img src='zenplot-17.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Now let's change the variable labels</span>
<span class='va'>z.</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>z.</span><span class='op'>)</span> <span class='op'>{</span>
                     <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>is.matrix</a></span><span class='op'>(</span><span class='va'>z.</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>z.</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>z.</span><span class='op'>)</span>
                     <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>z.</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Var."</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>z.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
                     <span class='va'>z.</span>
                     <span class='op'>}</span>
            <span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z.</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-18.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>### A dynamic plot based on 'loon' (if installed and R compiled with tcl support)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"loon"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
        <span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, pkg <span class='op'>=</span> <span class='st'>"loon"</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='co'>### Providing your own turns ###################################################</span>

<span class='co'>## A basic example</span>
<span class='va'>turns</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"l"</span>,<span class='st'>"d"</span>,<span class='st'>"d"</span>,<span class='st'>"r"</span>,<span class='st'>"r"</span>,<span class='st'>"d"</span>,<span class='st'>"d"</span>,<span class='st'>"r"</span>,<span class='st'>"r"</span>,<span class='st'>"u"</span>,<span class='st'>"u"</span>,<span class='st'>"r"</span>,<span class='st'>"r"</span>,<span class='st'>"u"</span>,<span class='st'>"u"</span>,<span class='st'>"l"</span>,<span class='st'>"l"</span>,
           <span class='st'>"u"</span>,<span class='st'>"u"</span>,<span class='st'>"l"</span>,<span class='st'>"l"</span>,<span class='st'>"u"</span>,<span class='st'>"u"</span>,<span class='st'>"l"</span>,<span class='st'>"l"</span>,<span class='st'>"d"</span>,<span class='st'>"d"</span>,<span class='st'>"l"</span>,<span class='st'>"l"</span>,<span class='st'>"d"</span>,<span class='st'>"d"</span>,<span class='st'>"l"</span>,<span class='st'>"l"</span>,
           <span class='st'>"d"</span>,<span class='st'>"d"</span>,<span class='st'>"r"</span>,<span class='st'>"r"</span>,<span class='st'>"d"</span>,<span class='st'>"d"</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='st'>"layout"</span>, plot2d <span class='op'>=</span> <span class='st'>"layout"</span>, turns <span class='op'>=</span> <span class='va'>turns</span><span class='op'>)</span> <span class='co'># layout of plot regions</span>
</div><div class='img'><img src='zenplot-19.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## =&gt; The tiles stick together as ispace = 0.</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='st'>"layout"</span>, plot2d <span class='op'>=</span> <span class='st'>"layout"</span>, turns <span class='op'>=</span> <span class='va'>turns</span>,
        pkg <span class='op'>=</span> <span class='st'>"grid"</span><span class='op'>)</span> <span class='co'># layout of plot regions with grid</span>
</div><div class='img'><img src='zenplot-20.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## =&gt; Here the tiles show the small (default) ispace</span>

<span class='co'>## Another example (with own turns and groups)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>4</span><span class='op'>:</span><span class='fl'>7</span><span class='op'>]</span><span class='op'>)</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow"</span>, plot2d <span class='op'>=</span> <span class='st'>"rect"</span>,
        turns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"d"</span>, <span class='st'>"r"</span>, <span class='st'>"r"</span>, <span class='st'>"r"</span>, <span class='st'>"r"</span>, <span class='st'>"d"</span>,
                  <span class='st'>"d"</span>, <span class='st'>"l"</span>, <span class='st'>"l"</span>, <span class='st'>"l"</span>, <span class='st'>"l"</span>, <span class='st'>"l"</span><span class='op'>)</span>, last1d <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-21.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>### Providing your own plot1d() or plot2d() ####################################</span>

<span class='co'>## Creating a box</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='st'>"label"</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
    <span class='fu'><a href='density_2d_graphics.html'>density_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, box <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-22.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## With grid</span>
<span class='co'># \donttest{</span>
    <span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='st'>"label"</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
        <span class='fu'><a href='density_2d_grid.html'>density_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span>, box <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-23.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'>## An example with width1d = width2d and where no zargs are passed on.</span>
<span class='co'>## Note: This could have also been done with 'rect_2d_graphics(zargs, col = ...)'</span>
<span class='co'>##       as plot1d and plot2d.</span>
<span class='va'>myrect</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='cn'>NA</span>, type <span class='op'>=</span> <span class='st'>"n"</span>, ann <span class='op'>=</span> <span class='cn'>FALSE</span>, axes <span class='op'>=</span> <span class='cn'>FALSE</span>, xlim <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, ylim <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/graphics/rect.html'>rect</a></span><span class='op'>(</span>xleft <span class='op'>=</span> <span class='fl'>0</span>, ybottom <span class='op'>=</span> <span class='fl'>0</span>, xright <span class='op'>=</span> <span class='fl'>1</span>, ytop <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, ncol <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>,
        n2dcol <span class='op'>=</span> <span class='st'>"square"</span>, width1d <span class='op'>=</span> <span class='fl'>10</span>, width2d <span class='op'>=</span> <span class='fl'>10</span>,
        plot1d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'>myrect</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"royalblue3"</span><span class='op'>)</span>,
        plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'>myrect</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"maroon3"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-24.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Colorized rugs as plot1d()</span>
<span class='va'>basecol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"royalblue3"</span>, <span class='st'>"darkorange2"</span>, <span class='st'>"maroon3"</span><span class='op'>)</span>
<span class='va'>palette</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='va'>basecol</span>, space <span class='op'>=</span> <span class='st'>"Lab"</span><span class='op'>)</span>
<span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span> <span class='co'># different color for each 1d plot</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
              <span class='fu'><a href='rug_1d_graphics.html'>rug_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, col <span class='op'>=</span> <span class='va'>cols</span><span class='op'>[</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
              <span class='op'>}</span>
       <span class='op'>)</span>
</div><div class='img'><img src='zenplot-25.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## With grid</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span> <span class='co'># for gTree() and gList()</span>
<span class='co'># \donttest{</span>
    <span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span>, <span class='co'># you are responsible for choosing the right pkg (cannot be tested!)</span>
            plot1d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
                <span class='fu'><a href='rug_1d_grid.html'>rug_1d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span>, col <span class='op'>=</span> <span class='va'>cols</span><span class='op'>[</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-26.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'>## Rectangles with labels as plot2d() (shows how to overlay plots)</span>
<span class='co'>## With graphics</span>
<span class='co'>## Note: myplot2d() could be written directly in a simpler way, but is</span>
<span class='co'>##       based on the two functions here to show how they can be combined.</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow"</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='rect_2d_graphics.html'>rect_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
    <span class='fu'><a href='label_2d_graphics.html'>label_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-27.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## With grid</span>
<span class='co'># \donttest{</span>
    <span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow"</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>gTree</a></span><span class='op'>(</span>children <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>gList</a></span><span class='op'>(</span><span class='fu'><a href='rect_2d_grid.html'>rect_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>,
                               <span class='fu'><a href='label_2d_grid.html'>label_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-28.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'>## Rectangles with labels outside the 2d plotting region as plot2d()</span>
<span class='co'>## With graphics</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow"</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='rect_2d_graphics.html'>rect_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
    <span class='fu'><a href='label_2d_graphics.html'>label_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>, xpd <span class='op'>=</span> <span class='cn'>NA</span>, srt <span class='op'>=</span> <span class='fl'>90</span>,
                      loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.04</span>, <span class='fl'>0</span><span class='op'>)</span>, adj <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, cex <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-29.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## With grid</span>
<span class='co'># \donttest{</span>
    <span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow"</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>gTree</a></span><span class='op'>(</span>children <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>gList</a></span><span class='op'>(</span><span class='fu'><a href='rect_2d_grid.html'>rect_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>,
                               <span class='fu'><a href='label_2d_grid.html'>label_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span>, loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.04</span>, <span class='fl'>0</span><span class='op'>)</span>,
                                             just <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"top"</span><span class='op'>)</span>,
                                             rot <span class='op'>=</span> <span class='fl'>90</span>, cex <span class='op'>=</span> <span class='fl'>0.45</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-30.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'>## 2d density with points, 1d arrows and labels</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>, plot1d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='rect_1d_graphics.html'>rect_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
    <span class='fu'><a href='arrow_1d_graphics.html'>arrow_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>, loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='label_1d_graphics.html'>label_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>, loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.8</span>, <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>, plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='points_2d_graphics.html'>points_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/adjustcolor.html'>adjustcolor</a></span><span class='op'>(</span><span class='st'>"black"</span>, alpha.f <span class='op'>=</span> <span class='fl'>0.4</span><span class='op'>)</span><span class='op'>)</span>
    <span class='fu'><a href='density_2d_graphics.html'>density_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-31.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## 2d density with labels, 1d histogram with density and label</span>
<span class='co'>## Note: The 1d plots are *improper* overlays here as the density</span>
<span class='co'>##       plot does not know the heights of the histogram. In other</span>
<span class='co'>##       words, both histograms and densities use the whole 1d plot</span>
<span class='co'>##       region but are not correct relative to each other in the</span>
<span class='co'>##       sense of covering the same are. For a *proper* overlay</span>
<span class='co'>##       see below.</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>,
    plot1d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
                    <span class='fu'><a href='hist_1d_graphics.html'>hist_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
                    <span class='fu'><a href='density_1d_graphics.html'>density_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>,
                                        border <span class='op'>=</span> <span class='st'>"royalblue3"</span>,
                                        lwd <span class='op'>=</span> <span class='fl'>1.4</span><span class='op'>)</span>
                    <span class='fu'><a href='label_1d_graphics.html'>label_1d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>,
                                      loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.8</span><span class='op'>)</span>,
                                      cex <span class='op'>=</span> <span class='fl'>0.6</span>, font <span class='op'>=</span> <span class='fl'>2</span>,
                                      col <span class='op'>=</span> <span class='st'>"darkorange2"</span><span class='op'>)</span>
                    <span class='op'>}</span>,
    plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
                    <span class='fu'><a href='density_2d_graphics.html'>density_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
                    <span class='fu'><a href='points_2d_graphics.html'>points_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>,
                                       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/adjustcolor.html'>adjustcolor</a></span><span class='op'>(</span><span class='st'>"black"</span>, alpha.f <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span>
                                <span class='op'>}</span>
            <span class='op'>)</span>
</div><div class='img'><img src='zenplot-32.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>### More sophisticated examples ################################################</span>

<span class='co'>### Example: Overlaying histograms with densities (the *proper* way)</span>
<span class='co'># \donttest{</span>
<span class='co'>## Define proper 1d plot for overlaying histograms with densities</span>
<span class='va'>hist_with_density_1d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
<span class='op'>{</span>
<span class='co'>## Extract information and data</span>
<span class='va'>num</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span> <span class='co'># plot number (among all 1d and 2d plots)</span>
<span class='va'>turn.out</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>turns</span><span class='op'>[</span><span class='va'>num</span><span class='op'>]</span> <span class='co'># turn out of current position</span>
<span class='va'>horizontal</span> <span class='op'>&lt;-</span> <span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"d"</span> <span class='op'>||</span> <span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"u"</span>
<span class='co'># the indices of the 'x' variable to be displayed in the current plot</span>
<span class='va'>ii</span> <span class='op'>&lt;-</span> <span class='fu'><a href='plot_indices.html'>plot_indices</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
<span class='va'>label</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"V"</span>, <span class='va'>ii</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># label</span>
<span class='va'>srt</span> <span class='op'>&lt;-</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>horizontal</span><span class='op'>)</span> <span class='fl'>0</span> <span class='kw'>else</span> <span class='kw'>if</span><span class='op'>(</span><span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"r"</span><span class='op'>)</span> <span class='op'>-</span><span class='fl'>90</span> <span class='kw'>else</span> <span class='fl'>90</span> <span class='co'># label rotation</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>x</span><span class='op'>[</span>,<span class='va'>ii</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='co'># data</span>
<span class='va'>lim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># data limits</span>
<span class='co'>## Compute histogram information</span>
<span class='va'>breaks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>lim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, to <span class='op'>=</span> <span class='va'>lim</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, length.out <span class='op'>=</span> <span class='fl'>21</span><span class='op'>)</span>
<span class='va'>binInfo</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>x</span>, breaks <span class='op'>=</span> <span class='va'>breaks</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>binBoundaries</span> <span class='op'>&lt;-</span> <span class='va'>binInfo</span><span class='op'>$</span><span class='va'>breaks</span>
<span class='va'>widths</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>binBoundaries</span><span class='op'>)</span>
<span class='va'>heights</span> <span class='op'>&lt;-</span> <span class='va'>binInfo</span><span class='op'>$</span><span class='va'>density</span>
<span class='co'>## Compute density information</span>
<span class='va'>dens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>xvals</span> <span class='op'>&lt;-</span> <span class='va'>dens</span><span class='op'>$</span><span class='va'>x</span>
<span class='va'>keepers</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='va'>xvals</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>xvals</span> <span class='op'>&lt;=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># keep those within the range of the data</span>
<span class='va'>x.</span> <span class='op'>&lt;-</span> <span class='va'>xvals</span><span class='op'>[</span><span class='va'>keepers</span><span class='op'>]</span>
<span class='va'>y.</span> <span class='op'>&lt;-</span> <span class='va'>dens</span><span class='op'>$</span><span class='va'>y</span><span class='op'>[</span><span class='va'>keepers</span><span class='op'>]</span>
<span class='co'>## Determine plot limits and data</span>
<span class='kw'>if</span><span class='op'>(</span><span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"d"</span> <span class='op'>||</span> <span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"l"</span><span class='op'>)</span> <span class='op'>{</span> <span class='co'># flip density/histogram</span>
    <span class='va'>heights</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>heights</span>
    <span class='va'>y.</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>y.</span>
<span class='op'>}</span>
<span class='kw'>if</span><span class='op'>(</span><span class='va'>horizontal</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='va'>lim</span>
    <span class='va'>xlim.bp</span> <span class='op'>&lt;-</span> <span class='va'>xlim</span> <span class='op'>-</span> <span class='va'>xlim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'># special for barplot(); need to shift the bars</span>
    <span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>heights</span>, <span class='va'>y.</span><span class='op'>)</span>
    <span class='va'>ylim.bp</span> <span class='op'>&lt;-</span> <span class='va'>ylim</span>
    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xlim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>x.</span>, <span class='va'>xlim</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>xlim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'># shift due to plot region set up by barplot()</span>
    <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>y.</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>heights</span>, <span class='va'>y.</span><span class='op'>)</span>
    <span class='va'>xlim.bp</span> <span class='op'>&lt;-</span> <span class='va'>xlim</span>
    <span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='va'>lim</span>
    <span class='va'>ylim.bp</span> <span class='op'>&lt;-</span> <span class='va'>ylim</span> <span class='op'>-</span> <span class='va'>ylim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'># special for barplot(); need to shift the bars</span>
    <span class='va'>x</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>y.</span>, <span class='fl'>0</span><span class='op'>)</span>
    <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xlim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>x.</span>, <span class='va'>xlim</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>ylim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'># shift due to plot region set up by barplot()</span>
<span class='op'>}</span>
<span class='co'>## Determining label position relative to the zenpath</span>
<span class='va'>loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.6</span><span class='op'>)</span>

<span class='co'># when walking downwards, change both left/right and up/down</span>
<span class='kw'>if</span><span class='op'>(</span><span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"d"</span><span class='op'>)</span> <span class='va'>loc</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>-</span><span class='va'>loc</span>

<span class='co'># when walking to the right, coordinates change and 2nd is flipped</span>
<span class='kw'>if</span><span class='op'>(</span><span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"r"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>loc</span><span class='op'>)</span>
    <span class='va'>loc</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>-</span><span class='va'>loc</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
<span class='op'>}</span>

<span class='co'># when walking to the left, coordinates change and 1st is flipped</span>
<span class='kw'>if</span><span class='op'>(</span><span class='va'>turn.out</span> <span class='op'>==</span> <span class='st'>"l"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>loc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>loc</span><span class='op'>)</span>
    <span class='va'>loc</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>-</span><span class='va'>loc</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='op'>}</span>
<span class='co'>## Plotting</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>heights</span>, width <span class='op'>=</span> <span class='va'>widths</span>, xlim <span class='op'>=</span> <span class='va'>xlim.bp</span>, ylim <span class='op'>=</span> <span class='va'>ylim.bp</span>,
        space <span class='op'>=</span> <span class='fl'>0</span>, horiz <span class='op'>=</span> <span class='op'>!</span><span class='va'>horizontal</span>, main <span class='op'>=</span> <span class='st'>""</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, axes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># histogram</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/polygon.html'>polygon</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, border <span class='op'>=</span> <span class='st'>"royalblue3"</span>, lwd <span class='op'>=</span> <span class='fl'>1.4</span><span class='op'>)</span> <span class='co'># density</span>
<span class='va'>opar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>usr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># switch to relative coordinates for text</span>
<span class='fu'><a href='https://rdrr.io/r/base/on.exit.html'>on.exit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>opar</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>loc</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>loc</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, labels <span class='op'>=</span> <span class='va'>label</span>, cex <span class='op'>=</span> <span class='fl'>0.7</span>, srt <span class='op'>=</span> <span class='va'>srt</span>, font <span class='op'>=</span> <span class='fl'>2</span>,
     col <span class='op'>=</span> <span class='st'>"darkorange2"</span><span class='op'>)</span> <span class='co'># label</span>
    <span class='op'>}</span>

<span class='co'>## Zenplot</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>x</span>,
plot1d <span class='op'>=</span> <span class='st'>"hist_with_density_1d"</span>,
plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
       <span class='fu'><a href='density_2d_graphics.html'>density_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
       <span class='fu'><a href='points_2d_graphics.html'>points_2d_graphics</a></span><span class='op'>(</span><span class='va'>zargs</span>,
                          add <span class='op'>=</span> <span class='cn'>TRUE</span>,
                          col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/adjustcolor.html'>adjustcolor</a></span><span class='op'>(</span><span class='st'>"black"</span>, alpha.f <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in zenplot(x, plot1d = "hist_with_density_1d", plot2d = function(zargs) {    density_2d_graphics(zargs)    points_2d_graphics(zargs, add = TRUE, col = adjustcolor("black",         alpha.f = 0.3))}): Function provided as argument 'plot1d' does not exist.</span></div><div class='input'><span class='co'># }</span>

<span class='co'>### Example: A path through pairs of a grouped t copula sample</span>

<span class='co'># \donttest{</span>
<span class='co'>## 1) Build a random sample from a 17-dimensional grouped t copula</span>
<span class='va'>d.</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>5</span>, <span class='fl'>4</span><span class='op'>)</span> <span class='co'># sector dimensions</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>d.</span><span class='op'>)</span> <span class='co'># total dimension</span>
<span class='va'>nu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>1</span>, <span class='fl'>0.25</span><span class='op'>)</span>, times <span class='op'>=</span> <span class='va'>d.</span><span class='op'>)</span> <span class='co'># d.o.f. for each dimension</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>500</span> <span class='co'># sample size</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>271</span><span class='op'>)</span>
<span class='va'>Z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>*</span> <span class='va'>d</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> <span class='co'># (d,n)-matrix</span>
<span class='va'>P</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0.5</span>, nrow <span class='op'>=</span> <span class='va'>d</span>, ncol <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>L</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/chol.html'>chol</a></span><span class='op'>(</span><span class='va'>P</span><span class='op'>)</span><span class='op'>)</span>   <span class='co'># L: LL^T = P</span>
<span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>L</span> <span class='op'>%*%</span> <span class='va'>Z</span><span class='op'>)</span> <span class='co'># (n,d)-matrix containing n d-vectors following N(0,P)</span>
<span class='va'>U.</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
<span class='va'>W</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>nu</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>nu.</span><span class='op'>)</span> <span class='fl'>1</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>qgamma</a></span><span class='op'>(</span><span class='va'>U.</span>, shape <span class='op'>=</span> <span class='va'>nu.</span><span class='op'>/</span><span class='fl'>2</span>, rate <span class='op'>=</span> <span class='va'>nu.</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># (n,d)-matrix</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>W</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>Y</span> <span class='co'># (n,d)-matrix</span>
<span class='va'>U</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>d</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>pt</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>[</span>,<span class='va'>j</span><span class='op'>]</span>, df <span class='op'>=</span> <span class='va'>nu</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># (n,d)-matrix</span>

<span class='co'>## 2) Plot the data with a pairs plot, colorizing the groups</span>
<span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='st'>"black"</span>, nrow <span class='op'>=</span> <span class='va'>d</span>, ncol <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span> <span class='co'># colors</span>
<span class='va'>start</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/Rgraphviz/man/AgEdge-class.html'>head</a></span><span class='op'>(</span><span class='va'>d.</span>, n <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span> <span class='co'># block start indices</span>
<span class='va'>end</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>d.</span><span class='op'>)</span> <span class='co'># block end indices</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>d.</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>cols</span><span class='op'>[</span><span class='va'>start</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>:</span><span class='va'>end</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span>, <span class='va'>start</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>:</span><span class='va'>end</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>basecol</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span> <span class='co'># colors</span>
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span> <span class='co'># remove colors corresponding to diagonal entries</span>
<span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span> <span class='co'># convert to a vector</span>
<span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='va'>cols</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>cols</span><span class='op'>)</span><span class='op'>]</span> <span class='co'># remove NA entries corresponding to diagonal</span>
<span class='va'>count</span> <span class='op'>&lt;-</span> <span class='fl'>0</span> <span class='co'># panel number</span>
<span class='va'>my_panel</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>...</span><span class='op'>)</span> <span class='co'># panel function for colorizing groups</span>
             <span class='op'>{</span> <span class='va'>count</span> <span class='op'>&lt;&lt;-</span> <span class='va'>count</span> <span class='op'>+</span> <span class='fl'>1</span>; <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, pch <span class='op'>=</span> <span class='st'>"."</span>, col <span class='op'>=</span> <span class='va'>cols</span><span class='op'>[</span><span class='va'>count</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/pairs.html'>pairs</a></span><span class='op'>(</span><span class='va'>U</span>, panel <span class='op'>=</span> <span class='va'>my_panel</span>, gap <span class='op'>=</span> <span class='fl'>0</span>,
     labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>as.expression</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>d</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/bquote.html'>bquote</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/plotmath.html'>italic</a></span><span class='op'>(</span><span class='va'>U</span><span class='op'>[</span><span class='fu'>.</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-33.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## 3) Zenplot of a random path through all pairs, colorizing the respective group</span>
<span class='co'>## Define our own points_2d_grid() for colorizing the groups</span>
<span class='va'>my_points_2d_grid</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span>, <span class='va'>basecol</span>, <span class='va'>d.</span><span class='op'>)</span> <span class='op'>{</span>
       <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='extract_2d.html'>extract_2d</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='co'># extract information from zargs</span>
       <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>$</span><span class='va'>x</span>
       <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>$</span><span class='va'>y</span>
       <span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>$</span><span class='va'>xlim</span>
       <span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>$</span><span class='va'>ylim</span>
       <span class='va'>num2d</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span><span class='op'>/</span><span class='fl'>2</span>
       <span class='va'>vars</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>$</span><span class='va'>vlabs</span><span class='op'>[</span><span class='va'>num2d</span><span class='op'>:</span><span class='op'>(</span><span class='va'>num2d</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># two variables to be plotted</span>
       <span class='co'>## Alternatively, we could have used ord[r$vars[num2d:(num2d+1)]] with</span>
       <span class='co'>## the order 'ord' (see below) being passed to my_points_2d_grid()</span>
       <span class='va'>col</span> <span class='op'>&lt;-</span> <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>&lt;=</span> <span class='va'>vars</span> <span class='op'>&amp;</span> <span class='va'>vars</span> <span class='op'>&lt;=</span> <span class='va'>d.</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span> <span class='va'>basecol</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
           <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>d.</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span> <span class='op'>&lt;=</span> <span class='va'>vars</span> <span class='op'>&amp;</span> <span class='va'>vars</span> <span class='op'>&lt;=</span> <span class='va'>d.</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='va'>d.</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span> <span class='va'>basecol</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
               <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>d.</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='va'>d.</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span> <span class='op'>&lt;=</span> <span class='va'>vars</span> <span class='op'>&amp;</span> <span class='va'>vars</span> <span class='op'>&lt;=</span> <span class='va'>d</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>basecol</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span> <span class='kw'>else</span> <span class='st'>"black"</span>
           <span class='op'>}</span>
       <span class='op'>}</span> <span class='co'># determine the colors</span>
       <span class='va'>vp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='vport.html'>vport</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>$</span><span class='va'>ispace</span>, xlim <span class='op'>=</span> <span class='va'>xlim</span>, ylim <span class='op'>=</span> <span class='va'>ylim</span>, x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='co'># viewport</span>
       <span class='fu'><a href='https://rdrr.io/r/grid/grid.points.html'>pointsGrob</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, pch <span class='op'>=</span> <span class='fl'>21</span>, size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>0.02</span>, units <span class='op'>=</span> <span class='st'>"npc"</span><span class='op'>)</span>,
                  name <span class='op'>=</span> <span class='st'>"points_2d"</span>, gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span>, vp <span class='op'>=</span> <span class='va'>vp</span><span class='op'>)</span>
   <span class='op'>}</span>
<span class='co'>## Plot a random permutation of columns via a zenplot</span>
<span class='co'>## Note: We set column labels here, as otherwise the labels can only</span>
<span class='co'>##       show *indices* of the variables to be plotted, i.e., the column</span>
<span class='co'>##       number in U[,ord], and not the original column number in U (which</span>
<span class='co'>##       is what we want to see in order to see how our 'path' through</span>
<span class='co'>##       the pairs of variables looks like).</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>U</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>d</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>ord</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>d</span>, size <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># path; 1:d would walk parallel to the secondary diagonal</span>
</div><div class='output co'>#&gt;  [1]  4  7  1  2 13 16 11 14  3 15  5 12 10  6 17  9  8</div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>U</span><span class='op'>[</span>,<span class='va'>ord</span><span class='op'>]</span>, plot1d <span class='op'>=</span> <span class='st'>"layout"</span>, plot2d <span class='op'>=</span> <span class='st'>"layout"</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span><span class='op'>)</span> <span class='co'># layout</span>
</div><div class='img'><img src='zenplot-34.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>U</span><span class='op'>[</span>,<span class='va'>ord</span><span class='op'>]</span>, <span class='co'># has correct variable names as column names</span>
        pkg <span class='op'>=</span> <span class='st'>"grid"</span>,
        plot1d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='fu'><a href='arrow_1d_grid.html'>arrow_1d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span>, col <span class='op'>=</span> <span class='st'>"grey50"</span><span class='op'>)</span>,
        plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span>
               <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>gTree</a></span><span class='op'>(</span>children <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>gList</a></span><span class='op'>(</span>
                   <span class='fu'>my_points_2d_grid</span><span class='op'>(</span><span class='va'>zargs</span>, basecol <span class='op'>=</span> <span class='va'>basecol</span>, d. <span class='op'>=</span> <span class='va'>d.</span><span class='op'>)</span>,
                   <span class='fu'><a href='rect_2d_grid.html'>rect_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span>, width <span class='op'>=</span> <span class='fl'>1.05</span>, height <span class='op'>=</span> <span class='fl'>1.05</span>,
                                col <span class='op'>=</span> <span class='st'>"grey50"</span>, lty <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
                   <span class='fu'><a href='label_2d_grid.html'>label_2d_grid</a></span><span class='op'>(</span><span class='va'>zargs</span>, loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.06</span>, <span class='op'>-</span><span class='fl'>0.03</span><span class='op'>)</span>,
                                 just <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"top"</span><span class='op'>)</span>, rot <span class='op'>=</span> <span class='fl'>90</span>, cex <span class='op'>=</span> <span class='fl'>0.45</span>,
                                 fontface <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-35.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## =&gt; The points are colorized correctly (compare with the pairs plot).</span>
<span class='co'># }</span>


<span class='co'>### Using ggplot2 ##############################################################</span>

<span class='co'>## Although not thoroughly tested, in principle ggplot2 can also be used via</span>
<span class='co'>## pkg = "grid" as follows.</span>
<span class='co'># \donttest{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='co'>## Define our own 2d plot</span>
<span class='va'>my_points_2d_ggplot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span>, <span class='va'>extract2d</span> <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
   <span class='op'>{</span>
       <span class='kw'>if</span><span class='op'>(</span><span class='va'>extract2d</span><span class='op'>)</span> <span class='op'>{</span>
           <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='extract_2d.html'>extract_2d</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='co'># extract results from zargs</span>
           <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>r</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span> <span class='co'># data frame</span>
           <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span>
           <span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>x</span><span class='op'>[</span>,<span class='st'>"Species"</span><span class='op'>]</span>
       <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
           <span class='va'>ii</span> <span class='op'>&lt;-</span> <span class='fu'><a href='plot_indices.html'>plot_indices</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='co'># the indices of the variables to be plotted</span>
           <span class='va'>irs</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>x</span> <span class='co'># iris data</span>
           <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>irs</span><span class='op'>[</span>,<span class='va'>ii</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>irs</span><span class='op'>[</span>,<span class='va'>ii</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># data frame</span>
           <span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='va'>irs</span><span class='op'>[</span>,<span class='st'>"Species"</span><span class='op'>]</span>
       <span class='op'>}</span>
       <span class='va'>num2d</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span><span class='op'>/</span><span class='fl'>2</span> <span class='co'># plot number among all 2d plots</span>
       <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, colour <span class='op'>=</span> <span class='va'>cols</span><span class='op'>)</span>,
                                  show.legend <span class='op'>=</span> <span class='va'>num2d</span> <span class='op'>==</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
           <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>, y <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='co'># 2d plot</span>
       <span class='kw'>if</span><span class='op'>(</span><span class='va'>num2d</span> <span class='op'>==</span> <span class='fl'>3</span><span class='op'>)</span> <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"bottom"</span>, <span class='co'># legend for last 2d plot</span>
                                     legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot_gtable.html'>ggplot_gtable</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot_build.html'>ggplot_build</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># 2d plot as grob</span>
   <span class='op'>}</span>

<span class='co'>## Plotting</span>
<span class='va'>iris.</span> <span class='op'>&lt;-</span> <span class='va'>iris</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>iris.</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\\\."</span>, <span class='st'>" "</span>, x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>iris</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># =&gt; nicer 1d labels</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>iris.</span>, n2dplots <span class='op'>=</span> <span class='fl'>3</span>, plot2d <span class='op'>=</span> <span class='st'>"my_points_2d_ggplot"</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in zenplot(iris., n2dplots = 3, plot2d = "my_points_2d_ggplot",     pkg = "grid"): Function provided as argument 'plot2d' does not exist.</span></div><div class='input'><span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>iris.</span>, n2dplots <span class='op'>=</span> <span class='fl'>3</span>,
        plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='fu'>my_points_2d_ggplot</span><span class='op'>(</span><span class='va'>zargs</span>, extract2d <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
        pkg <span class='op'>=</span> <span class='st'>"grid"</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-36.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>


<span class='co'>### Providing your own data structure ##########################################</span>

<span class='co'># \donttest{</span>
<span class='co'>## Danger zone: An example with a new data structure (here: a list of *lists*)</span>
<span class='co'>## Note: - In this case, we most likely need to provide both plot1d and plot2d</span>
<span class='co'>##         (but not in this case here since arrow_1d_graphics() does not depend</span>
<span class='co'>##         on the data structure)</span>
<span class='co'>##       - Note that we still make use of zargs here.</span>
<span class='co'>##       - Also note that the variables are not correctly aligned anymore:</span>
<span class='co'>##         In the ggplot2 examples we guaranteed this by plot_indices(),</span>
<span class='co'>##         but here we don't. This then still produces our layout but the</span>
<span class='co'>##         x/y axis of adjacent plots might not be the same anymore. This is</span>
<span class='co'>##         fine if only a certain order of the plots is of interest, but</span>
<span class='co'>##         not a comparison between adjacent plots.</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>z</span>, n2dplots <span class='op'>=</span> <span class='fl'>4</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow"</span>, last1d <span class='op'>=</span> <span class='cn'>FALSE</span>,
        plot2d <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
            <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>$</span><span class='va'>x</span>, recursive <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
            <span class='va'>num2d</span> <span class='op'>&lt;-</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span><span class='op'>/</span><span class='fl'>2</span> <span class='co'># plot number among 2d plots</span>
            <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>[[</span><span class='va'>num2d</span><span class='op'>]</span><span class='op'>]</span>
            <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>r</span><span class='op'>[[</span><span class='va'>num2d</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
            <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>x</span>, length.out <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
            <span class='kw'>else</span> <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>y</span>, length.out <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
            <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, xlab <span class='op'>=</span> <span class='st'>""</span>, ylab <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
        <span class='op'>}</span>, ispace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-37.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>


<span class='co'>### Zenplots based on 3d lattice plots #########################################</span>

<span class='co'># \donttest{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://lattice.r-forge.r-project.org/'>lattice</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>grid</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gridExtra</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘gridExtra’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:BiocGenerics’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    combine</span></div><div class='input'>
<span class='co'>## Build a list of cloud() plots (trellis objects)</span>
<span class='co'>## Note:</span>
<span class='co'>## - 'grid' problem: Without print(), the below zenplot() may fail (e.g.,</span>
<span class='co'>##   in fresh R sessions) with: 'Error in UseMethod("depth") :</span>
<span class='co'>##   no applicable method for 'depth' applied to an object of class "NULL"'</span>
<span class='co'>## - col = "black" inside scales is needed to make the ticks show</span>
<span class='va'>mycloud</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>num</span><span class='op'>)</span> <span class='op'>{</span>
       <span class='va'>lim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/extendrange.html'>extendrange</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, f <span class='op'>=</span> <span class='fl'>0.04</span><span class='op'>)</span>
       <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/cloud.html'>cloud</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>, <span class='fl'>3</span><span class='op'>]</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>x</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, xlim <span class='op'>=</span> <span class='va'>lim</span>, ylim <span class='op'>=</span> <span class='va'>lim</span>, zlim <span class='op'>=</span> <span class='va'>lim</span>,
                   xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span><span class='op'>(</span><span class='va'>U</span><span class='op'>[</span><span class='va'>i.</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>i. <span class='op'>=</span> <span class='va'>num</span><span class='op'>)</span><span class='op'>)</span>,
                   ylab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span><span class='op'>(</span><span class='va'>U</span><span class='op'>[</span><span class='va'>i.</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>i. <span class='op'>=</span> <span class='va'>num</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
                   zlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span><span class='op'>(</span><span class='va'>U</span><span class='op'>[</span><span class='va'>i.</span><span class='op'>]</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>i. <span class='op'>=</span> <span class='va'>num</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
                   zoom <span class='op'>=</span> <span class='fl'>1</span>, scales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='cn'>FALSE</span>, col <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,
                   col <span class='op'>=</span> <span class='st'>"black"</span>,
                   par.settings <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/lattice/man/trellis.device.html'>standard.theme</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>,
                                       axis.line <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"transparent"</span><span class='op'>)</span>,
                                       clip <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>panel <span class='op'>=</span> <span class='st'>"off"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
   <span class='op'>}</span>
<span class='va'>plst.3d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>
       <span class='fu'>mycloud</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='va'>i</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>, num <span class='op'>=</span> <span class='va'>i</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># list of trellis objects</span>
</div><div class='img'><img src='zenplot-38.png' alt='' width='700' height='433' /></div><div class='img'><img src='zenplot-39.png' alt='' width='700' height='433' /></div><div class='img'><img src='zenplot-40.png' alt='' width='700' height='433' /></div><div class='img'><img src='zenplot-41.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Preparing the zenplot</span>
<span class='va'>num</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>plst.3d</span><span class='op'>)</span>
<span class='va'>ncols</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>turns</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"r"</span>, <span class='fl'>2</span><span class='op'>*</span><span class='op'>(</span><span class='va'>ncols</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"d"</span>, <span class='st'>"d"</span>,
           <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"l"</span>, <span class='fl'>2</span><span class='op'>*</span><span class='op'>(</span><span class='va'>ncols</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"d"</span><span class='op'>)</span>
<span class='va'>plot2d</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>)</span> <span class='op'>{</span>
       <span class='va'>num2d</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>zargs</span><span class='op'>$</span><span class='va'>num</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span>
       <span class='va'>vp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='vport.html'>vport</a></span><span class='op'>(</span><span class='va'>zargs</span><span class='op'>$</span><span class='va'>ispace</span>, xlim <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, ylim <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>)</span>
       <span class='fu'><a href='https://rdrr.io/r/grid/grid.grob.html'>grob</a></span><span class='op'>(</span>p <span class='op'>=</span> <span class='va'>zargs</span><span class='op'>$</span><span class='va'>x</span><span class='op'>[[</span><span class='va'>num2d</span><span class='op'>]</span><span class='op'>]</span>, vp <span class='op'>=</span> <span class='va'>vp</span>, cl <span class='op'>=</span> <span class='st'>"lattice"</span><span class='op'>)</span> <span class='co'># convert trellis to grid object</span>
       <span class='co'>## Note: For further plots, Work with</span>
       <span class='co'>##       gTree(children = gList(grob(zargs$x[[num2d]], vp = vp,</span>
       <span class='co'>##                                   cl = "lattice")))</span>
   <span class='op'>}</span>

<span class='co'>## Zenplot</span>
<span class='co'>## Note: We use a list of *plots* here already (not data)</span>
<span class='fu'>zenplot</span><span class='op'>(</span><span class='va'>plst.3d</span>, turns <span class='op'>=</span> <span class='va'>turns</span>, n2dplots <span class='op'>=</span> <span class='va'>num</span>, pkg <span class='op'>=</span> <span class='st'>"grid"</span>, first1d <span class='op'>=</span> <span class='cn'>FALSE</span>,
        last1d <span class='op'>=</span> <span class='cn'>FALSE</span>, plot1d <span class='op'>=</span> <span class='st'>"arrow_1d_grid"</span>, plot2d <span class='op'>=</span> <span class='va'>plot2d</span><span class='op'>)</span>
</div><div class='img'><img src='zenplot-42.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marius Hofert, Wayne Oldford.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


